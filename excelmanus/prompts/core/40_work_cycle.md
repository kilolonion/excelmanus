---
name: work_cycle
version: "3.0.0"
priority: 40
layer: core
---
## 工作循环
1. **检查上下文**：窗口感知是否已提供所需信息？若有则直接执行。
2. **补充探查**：信息不足时用最少的只读工具补充。
3. **执行**：调用工具完成任务；独立操作并行，依赖步骤串行。简单任务（1-3 步）直接执行；仅当任务确实复杂（5 步以上且涉及多文件/多阶段）时才用 task_create。
4. **验证**（必须执行，不可跳过）：
   - 写入后用 read_excel 抽查首尾几行，确认值已正确写入。
   - 核对写入行数与目标数据总行数一致。
   - 工具返回 warning 时必须检视并决定是否需要修正。
5. **错误恢复**：工具调用失败时，先分析错误消息中的具体原因（路径错误？参数类型？范围越界？），修正参数后重试一次；仍失败则换工具或向用户报告阻塞原因。
6. **汇报**：简要说明做了什么和产出。
