---
name: table_layout
version: "2.0.0"
priority: 46
layer: strategy
max_tokens: 550
conditions:
  chat_mode: "write"
---
## 表格排版规范

生成或格式化表格时，遵循以下专业排版约定：

### 1. 对齐约定

| 数据类型 | 水平对齐 | 垂直对齐 |
|---------|---------|---------|
| 数字/金额/百分比 | **右对齐** | 居中 |
| 纯文本/名称/描述 | **左对齐** | 居中 |
| 日期/时间 | 居中或左对齐 | 居中 |
| 表头行 | **居中** | 居中 |
| 标题行（合并单元格） | **居中** | 居中 |
| 合并单元格内容 | 居中 | 居中 |
| 汇总行标签（如"合计"） | 右对齐或居中 | 居中 |

### 2. 行高参考值（pt）

- **大标题行**：32–40（合并居中、大号字体）
- **表头行**：24–28（加粗、底色）
- **数据行**：18–22（标准）
- **汇总行**：22–26（加粗、上双线）
- 含 CJK 文本的行适当加高 10–15%

### 3. 列宽与收尾

- 数据写入完成后 **always** 调用 `adjust_column_width(auto_fit=True)` 自动适配列宽
- 随后调用 `adjust_row_height(auto_fit=True)` 自动适配行高
- 标题列 / ID 列最小宽度 ≥ 12
- 同类数字列保持统一宽度（取最大值）

### 4. 专业表格结构模式

1. **标题区**：合并首行 → 大号字体 + 深色底 + 白色字 + 居中
2. **表头**：加粗 + 浅底色 + 居中 + 四边细框线
3. **数据区**：按类型对齐 + 纵向细框线 + 可选交替行色
4. **汇总行**：加粗 + 上方双线分隔 + 数字右对齐

### 5. 边框哲学

- **默认隐去网格线**：专业表格不依赖满屏网格，仅在需要区分区域时加线。
- **推荐层级**：表头下方用 medium 粗线分隔；数据区仅用 thin 横线或不加线，靠交替行色引导视线；汇总行上方用 double 双线。
- **禁止全包围粗框**：避免每个单元格四边粗线，视觉沉重。外边框可选 thin 或无。

### 6. 配色克制

- **三色原则**：1 主色（表头/标题底色）+ 1 辅色（强调/条件格式）+ 中性灰（交替行/边框），其余保持白底黑字。
- **安全主色推荐**：深蓝 002060、天蓝 4472C4、深绿 375623、暗红 823535、深灰 404040。
- **浅底色一律低饱和**：表头底色用主色，交替行底色用极浅灰 F2F2F2 或 F5F5F5，禁止用高饱和色做大面积填充。
- **文字可读性**：浅色背景配深色字（黑/深灰），深色背景配白色字，对比度保持 4.5:1 以上。

### 7. 字体与排版

- **字体选择**：优先 Calibri / Arial / 微软雅黑（CJK），全表统一 1 种字体，禁止混用装饰体。
- **字号层级**：大标题 14–16pt → 表头 11–12pt（加粗）→ 正文 10–11pt → 注释/脚注 9pt（灰色）。
- **数字格式**：金额加千分位 `#,##0.00`，百分比 `0.0%`，日期 `YYYY-MM-DD`，保持同列统一。
