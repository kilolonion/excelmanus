{
  "suite_name": "复杂综合压力测试（12题精选）",
  "description": "从 SpreadsheetBench verified-400 中精选 12 道高难度题目，覆盖跨表合并、复杂数据变换、大范围公式计算、不规则解析等维度。8 道 Sheet-Level + 4 道 Cell-Level，平均 instruction 长度 700+。用于压测 ExcelManus 的 run_code 能力、多步推理、大数据处理。",
  "source": "SpreadsheetBench (NeurIPS 2024) — bench/external/spreadsheetbench/spreadsheetbench_verified_400",
  "trace": true,
  "sampling": {
    "method": "manual_curated",
    "seed": 20260220,
    "total": 12,
    "pool_size": 400,
    "cell_level": 4,
    "sheet_level": 8
  },
  "assertions": {
    "status": "ok",
    "max_iterations": 20,
    "max_tool_failures": 3,
    "no_empty_promise": true
  },
  "cases": [
    {
      "id": "sb_80_42",
      "name": "[跨表合并8000行到汇总表+来源标记] SpreadsheetBench #80-42",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/80-42/1_80-42_init.xlsx. How can I consolidate all rows of data from all other sheets in the workbook (currently, Jack, Henry, and Richard sheets) into the first available, blank rows of A:L in sheet Consolidated_ALL, and ensure that each row of consolidated data has an indication of the originating sheet name in Column L?  The columns to use from the other sheets are highlighted yellow.  Match the cell formatting and data layout of other rows in the sheet.  Do not include column headers or fill colors in this consolidation.  Additionally, how can I adapt the VBA code provided to either increase or decrease the number of columns it operates with based on my requirements?",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "large_output"
      ],
      "expected": {
        "answer_position": "'Consolidate_ALL'!A2:L8000",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/80-42/1_80-42_golden.xlsx",
        "source_id": "80-42",
        "answer_sheet": "Consolidate_ALL"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/80-42/1_80-42_init.xlsx"
      ]
    },
    {
      "id": "sb_203_15",
      "name": "[跨列透视+新表创建+多维汇总] SpreadsheetBench #203-15",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/203-15/1_203-15_init.xlsx. I'm using Excel 2013 and have a main sheet that has data for staff,  which has headers in row 1 spanning from columns A to J. The names of the allowances are in column H, and I need a macro to perform the following tasks: 1) Create a new output sheet 'Output Required'; 2) Copy headers from A1 to G1 from the main sheet to the output sheet, and then copy the allowances details, which are in column H from the main sheet, into this new sheet in a transposed manner such that 'Basic', 'Housing Allowance', 'Transport Allowance', 'Other Allowance', and 'Social Allowance' will each be in separate columns; 3) Arrange the data so each staff member's output occupies only one row on the output sheet; 4) Calculate the total for each row and place it under column M on the output sheet. The cells in my provided sample are colored for explanation purposes only.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'Output Required'!A1:M3",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/203-15/1_203-15_golden.xlsx",
        "source_id": "203-15",
        "answer_sheet": "Output Required"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/203-15/1_203-15_init.xlsx"
      ]
    },
    {
      "id": "sb_82_38",
      "name": "[跨表发票号匹配+重复填充] SpreadsheetBench #82-38",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/82-38/1_82-38_init.xlsx. On my SH1 sheet, there are multiple headers labeled 'INVOICE NO' with a number underneath each for different ranges. In my DATA sheet, column D should match the 'INVOICE NO' from SH1 and repeat for each header until a 'TOTAL' row, which correlates with the sheet name in column E of the DATA sheet. The invoice numbers should be arranged in the order they appear on SH1 when the sheet names match; otherwise, sheets with names that do not match should be ignored. I initially wanted formulas that do not specify a range and dynamically work up to the last row containing data. However, I encountered a problem when the DATA sheet has more data than the SH1 sheet, resulting in a #NUM! error. I want to keep the original numbers after the new ones have been filled in and only fill in column D when there is a matching sheet name in column E, while ignoring rows with unmatched names or extra data. Can you provide a solution or VBA code that addresses these issues?",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'DATA'!D2:D20",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/82-38/1_82-38_golden.xlsx",
        "source_id": "82-38",
        "answer_sheet": "DATA"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/82-38/1_82-38_init.xlsx"
      ]
    },
    {
      "id": "sb_191_40",
      "name": "[分块排序-自动检测块边界+降序] SpreadsheetBench #191-40",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/191-40/1_191-40_init.xlsx. I need a macro or a similar function that can sort varying blocks of numbers on Sheet1 by column D in descending order. Each block is separated by one blank row, and both the number of rows per block and the total number of blocks can vary. The process should automatically detect each block, sort only the numeric data rows within each block, and keep exactly one blank row between blocks after sorting.\n\nColumns D–F contain formulas that calculate from other columns (for example, D uses =Brow+Crow). These formulas must remain as formulas that display their evaluated numeric results — they should not convert to text. Round off all numbers to one decimal place (##0.0) and the whole numbers display without a decimal point ((like ##0, not ##0.). Before sorting, ensure any text-stored formulas are converted back to real formulas and that Excel is set to Automatic Calculation, so column D evaluates as numbers. Sorting must use the evaluated numeric values of column D, not text order, and all formulas in D–F must continue to reference the correct cells on their respective rows after sorting.  \n\nPreserve all existing formatting, number formats, and column widths. Recheck to make sure columns D, E and F are bold and center-aligned and the number formatting instructions provided earlier are followed.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'Sheet1'!A1:H85",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/191-40/1_191-40_golden.xlsx",
        "source_id": "191-40",
        "answer_sheet": "Sheet1"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/191-40/1_191-40_init.xlsx"
      ]
    },
    {
      "id": "sb_247_24",
      "name": "[多条件行删除+列操作+动态检测] SpreadsheetBench #247-24",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/247-24/1_247-24_init.xlsx. I require a VBA code to manage a dataset in an Excel sheet. Specifically, I need the code to dynamically identify and carry out the following tasks in the Main sheet: 1) Delete rows where the Company name in Column A is 'Motorcycle'; 2) Delete rows where the Company name in Column A is 'Ahmed Sons' and the Location in column B is Canada; 3) Change the 'Bill Rate of Resource' in Column G to 180 for rows where the Company is 'National TV' and the Location is India; 4) Insert two new rows immediately following each row where the Company name in Column A is 'Ahmed Sons'; 5) Perform a VLOOKUP or similar operation to populate Column M with the 'working Weeks' data from a second sheet named Lookup, matching on 'Employee Ids' in Column C from the Main sheet. The accompanying Excel file provides the data structure that the code needs to handle. Make sure there is no output remaining in the deleted rows after the VLOOKUP is performed. Alternatively, carry out this task without VBA.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'Main!'A2:M70",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/247-24/1_247-24_golden.xlsx",
        "source_id": "247-24",
        "answer_sheet": "Main,Lookup"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/247-24/1_247-24_init.xlsx"
      ]
    },
    {
      "id": "sb_61_4",
      "name": "[连续负值检测+股票数据合并] SpreadsheetBench #61-4",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/61-4/1_61-4_init.xlsx. How can I identify consecutive negative values in a column for specific stock names, and then merge the related data such that only the opening price from the first date, the closing price from the last date, the highest 'high' price, the lowest 'low' price within those dates are kept, and the volume from these dates is summed? This summarized data should then be sent to an output sheet. The input and output formats are illustrated in an attached Excel document, with color coding for clarity.Remarks : please chek comments inside cell C2,D2,E2,F2,G2.For better understanding, I kept the output to column K:Q,but this data will be shifted to \"Output sheet\".",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex"
      ],
      "expected": {
        "answer_position": "'output'!A2:G15",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/61-4/1_61-4_golden.xlsx",
        "source_id": "61-4",
        "answer_sheet": "output"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/61-4/1_61-4_init.xlsx"
      ]
    },
    {
      "id": "sb_367_23",
      "name": "[正负值配对归零+条件行删除] SpreadsheetBench #367-23",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/367-23/1_367-23_init.xlsx. I have written a macro that should delete rows from a worksheet named 'Final Recon Items' where the values in column D (4th column), containing positive or negative values of 0.01, sum up to zero. The macro I've attempted to use is not working as expected; it fails to delete the relevant rows even though the sum of the values appears to be zero. However, a forum expert pointed out that the actual values include slight variations due to precision, such as -1.00000000093132E-02, -9.99999999476131E-03, 9.9999999802094E-03, and 1.00000000020373E-02, which are not strictly equal to zero. The expert suggested using an absolute value check with a threshold of 0.011 to identify values that are effectively zero for the purpose of deletion, but implementing this results in a runtime error 'Type Mismatch' and I am unable to resolve it. Additionally, it was mentioned that in the first row of column 4 there's a non-numeric value 'Amount' which could be related to the issue. I need help in correcting the macro code to perform the intended row-deletion operation accurately.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'final Recon Items'!A1:D5",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/367-23/1_367-23_golden.xlsx",
        "source_id": "367-23",
        "answer_sheet": "final Recon Items"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/367-23/1_367-23_init.xlsx"
      ]
    },
    {
      "id": "sb_496_34",
      "name": "[重复ID合并计数+金额汇总] SpreadsheetBench #496-34",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/496-34/1_496-34_init.xlsx. I need assistance with an Excel macro to handle duplicate ID numbers in column A. Specifically, I want to count the total amount for each ID, but considering the duplicates as a single ID. For illustration, I have attached a picture representing the expected result along with my Excel workbook named Book1.xlsm. How can I achieve this in VBA?\nAll the transformations below only apply to the data in col A:D, leave other columns the same (change nothing in col F:H i.e merged cells stay merged with same formatting)\n- \tUnmerge any merged cells in the worksheet\n-\t'Amount' values should be reported as integers (no decimals)\n-\tAll data in the table should not be bold and use font color #000000\n-\tKeep the formatting of dates the same: i.e m/dd/yyyy hh:ss\n-\tThe 2 values in columns F should be placed in the same row as the first and last ID number, respectively",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'Sheet1'!A2:D8",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/496-34/1_496-34_golden.xlsx",
        "source_id": "496-34",
        "answer_sheet": "Sheet1"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/496-34/1_496-34_init.xlsx"
      ]
    },
    {
      "id": "sb_44017",
      "name": "[滚动价格增长-时间序列+频率计算] SpreadsheetBench #44017",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/44017/1_44017_init.xlsx. I need to calculate updated rates for each customer based on price increases that roll out over time. Each customer has baseline rates in a 12-month historical range, an effective start date when increases begin applying, and a frequency value (representing months between waves) that determines when each increase takes effect. There are up to four sequential price increase percentages defined in separate columns.Create formulas in columns AD through AO starting at row 14 that calculate new rates by applying cumulative price increases to the base rate in column W. The increases should phase in based on the effective date in column L, the frequency in column J, and the increase percentages in columns M through P. Each column represents a different month with dates in row 9. Only show values when the column date is on or after the effective date. There should be no yellow fill in the cells you complete.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level",
        "complex",
        "very_long_instruction",
        "large_output"
      ],
      "expected": {
        "answer_position": "AD14:AO42",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/44017/1_44017_golden.xlsx",
        "source_id": "44017"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/44017/1_44017_init.xlsx"
      ]
    },
    {
      "id": "sb_9569",
      "name": "[1280行大范围-最早非零值检测] SpreadsheetBench #9569",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/9569/1_9569_init.xlsx. I need a formula to identify the earliest non-zero value entered for each row, specifically within column 'AO,' from a range of months (e.g., from Jan 2015 onward). The workbook I'm working on will be updated monthly with new data, and the values are percentages such as 17.07% for contract #10007 in Mar-2015. It is important that the formula avoids using array formulas to prevent the workbook from freezing due to a potentially long list of data.\nI am struggling to find a formula that I could use in order to find the EARLIEST value entered from several months. Attached is a workbook that will be populated each month and will potentially have values from Jan 2015 through whatever the latest month would be........for each row, I need to pick the earliest value entered on column \"AO\". As an example on 1st row, the earliest value for contract # 10007 is 17.07% entered in Mar-2015, contract 10008 would 18.20% entered in Jun 2015, etc..Since this list will be long, it would be preferable to have a formula that does not use array formulas as I find that this type of formula typically freezes the workbook. Need to enter a formula that captures the earliest value entered from any given time period without manually entering value in each row.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level",
        "complex",
        "very_long_instruction",
        "large_output"
      ],
      "expected": {
        "answer_position": "AO9:AO1288",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/9569/1_9569_golden.xlsx",
        "source_id": "9569"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/9569/1_9569_init.xlsx"
      ]
    },
    {
      "id": "sb_58949",
      "name": "[多行转单行横向展开-数据重组] SpreadsheetBench #58949",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/58949/1_58949_init.xlsx. I need to reorganize data exported from our database where multiple rows correspond to single clients with various details about them. The goal is to have each unique client ID appear only once in a new tab, aligning respective data horizontally across multiple columns. A single client's data could be across one column or expand to 200 columns based on the number of details available. I am currently using VBA to do this, but it only outputs as many columns as there are details per client. I want to modify it or create a formula that will use a pre-defined list of headers and fill in 'N/A' where data is missing. Below is my VBA code, but I need advice on what changes to make or how to set up an effective formula to achieve the desired layout in \"Desired Result\" sheet, which is illustrated in the attached 'Problem Example.xlsx' file.\nThe formula data output result may be an empty string.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "'Desired Result'!B2:I5",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/58949/1_58949_golden.xlsx",
        "source_id": "58949"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/58949/1_58949_init.xlsx"
      ]
    },
    {
      "id": "sb_59794",
      "name": "[不规则分隔符拆列-复杂解析] SpreadsheetBench #59794",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/59794/1_59794_init.xlsx. How can I correctly split the information from one column (column A labeled 'INITIAL INFORMATION Column1') into multiple new columns (column C-K labeled 'FINAL INFORMATION') in Excel, given the complexity that the delimiters (specifically '/', '-') are not consistently placed and could differ in number from row to row? I have tried using different formulas and the Text to Columns feature without satisfactory results, resulting in much manual correction. Additionally, while I've received suggestions using formulas and Power Query, they don't seem to handle the inconsistency in the pattern and delimiters across rows in my file.   So to be clear, what I need for you to do is split the data by forward slash delimiter and preserve all segments exactly as they appear, including any standalone dash characters, distributing them across the target columns.  And if any new columns need to be made, create them accordingly and format them the same as the adjacent columns to the left.  Then once all values are output, shade the cells with the formula in #E2EFDA",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level",
        "complex",
        "very_long_instruction"
      ],
      "expected": {
        "answer_position": "C3:M5",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/59794/1_59794_golden.xlsx",
        "source_id": "59794"
      },
      "source_files": [
        "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/59794/1_59794_init.xlsx"
      ]
    }
  ]
}