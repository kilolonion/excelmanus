{
  "suite_name": "SpreadsheetBench 抽样套件",
  "description": "从 SpreadsheetBench verified-400 中抽取 8 题，覆盖 Cell-Level 公式计算与 Sheet-Level 数据操作，用于评估 Agent 的 Excel 操作能力",
  "source": "SpreadsheetBench (NeurIPS 2024) — bench/external/spreadsheetbench/spreadsheetbench_verified_400",
  "cases": [
    {
      "id": "sb_49801_concat_left_right",
      "name": "字符串拼接 LEFT+RIGHT",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/49801/1_49801_init.xlsx. In Excel, combine the results of both the LEFT 2 characters of a cell and RIGHT 3 characters of another cell into a single cell. I have the value 'SL-BK56-OWWFST-0035' and I use '=LEFT(A1,2)' in Column B which returns 'SL', and I use '=RIGHT(A1,5)' which returns '-0035'. Please concatenate these two formulas into one to get the result 'SL-0035' in column C. Do not add any additional labels or examples.",
      "tags": ["cell_level", "formula", "string", "spreadsheetbench"],
      "expected": {
        "answer_position": "C1",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/49801/1_49801_golden.xlsx",
        "source_id": 49801
      }
    },
    {
      "id": "sb_46167_sumifs",
      "name": "条件求和 SUMIFS",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/46167/1_46167_init.xlsx. How can I create a formula in Excel that will calculate the sum of multiple cells subject to a specific criterion? Specifically, I want to sum the quantities (QTY) in a column for the rows where the 'PRODUCT ID' matches a given value (e.g., 111111). Please output the answer in D2. For example, the expected result of this sum for 'PRODUCT ID' 111111 should be 270, deriving from the individual QTY values of 50, 60, 70, and 90. Sum of QTYs where PRODUCT ID=111111.",
      "tags": ["cell_level", "formula", "sumifs", "spreadsheetbench"],
      "expected": {
        "answer_position": "D2",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/46167/1_46167_golden.xlsx",
        "source_id": 46167
      }
    },
    {
      "id": "sb_54675_countifs_wildcard",
      "name": "条件计数 COUNTIFS（含通配符）",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/54675/1_54675_init.xlsx. How can I modify my Excel formula in cell F3 so it counts all occurrences of the name 'Gary Stoddard' in column B, including those that appear in a cell with other names, as long as column A contains the number '4'? The current formula COUNTIFS(B:B,\"Gary Stoddard\",A:A,\"4\") only matches exact cells.",
      "tags": ["cell_level", "formula", "countifs", "wildcard", "spreadsheetbench"],
      "expected": {
        "answer_position": "F3",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/54675/1_54675_golden.xlsx",
        "source_id": 54675
      }
    },
    {
      "id": "sb_38074_profit_calc",
      "name": "利润计算（向量化条件匹配）",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/38074/1_38074_init.xlsx. I need to calculate the profit in a table by subtracting expenses (1,2,3). The columns contain both profit and expenses values, but I need to evaluate this calculation based where column A matches the case sensitive values in J2 using vectorized operations. The formula should go in cells K2:K5. Furthermore, after resolving the issue, amend the formula to consider blank cells as zeros, and format final output without decimals.",
      "tags": ["cell_level", "formula", "calculation", "vectorized", "spreadsheetbench"],
      "expected": {
        "answer_position": "K2:K5",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/38074/1_38074_golden.xlsx",
        "source_id": 38074
      }
    },
    {
      "id": "sb_51431_extract_name",
      "name": "提取首个姓名",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/51431/1_51431_init.xlsx. Build a formula that can help me extract the first name from a string of names in a cell. I'm aware of the TEXT TO COLUMNS function, but it's not always suitable for the dataset I'm working with. For example, I want the first full name listed in cell A2, which contains names separated by semicolons, to be displayed in cell B2. Full Name and separator example: \"name, name;\"",
      "tags": ["cell_level", "formula", "string_extract", "spreadsheetbench"],
      "expected": {
        "answer_position": "B2",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/51431/1_51431_golden.xlsx",
        "source_id": 51431
      }
    },
    {
      "id": "sb_60_7_cross_sheet_merge",
      "name": "跨表合并（加减法）",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/60-7/1_60-7_init.xlsx. How can I update the data in a 'Consolidated Tracker' tab in Excel by combining the rows from an 'Existing Task' sheet and an 'Additions' sheet, and subtracting the rows from a 'Retired' sheet? The operation should result in the 'Consolidated Tracker' containing the final list of net activities, effectively calculated as 'Consolidated Tracker = Existing Task + Additions - Retired'. Please output the answer from position A3 in the table, and make sure that the position of the corresponding column is correct.",
      "tags": ["sheet_level", "cross_sheet", "merge", "spreadsheetbench"],
      "expected": {
        "answer_position": "A3:E11",
        "answer_sheet": "Consolidated Tracker",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/60-7/1_60-7_golden.xlsx",
        "source_id": "60-7"
      }
    },
    {
      "id": "sb_178_22_filter_extract_rows",
      "name": "按条件提取行到新 Sheet",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/178-22/1_178-22_init.xlsx. Extract rows from Sheet1 where column B equals 'TELIVISION' OR column C equals 'CLASS III' OR column C equals 'CLASS IV'. Put the results in Sheet2 starting at A3 with headers in A2.",
      "tags": ["sheet_level", "filter", "extract", "cross_sheet", "spreadsheetbench"],
      "expected": {
        "answer_position": "'Sheet2'!A1:C18",
        "answer_sheet": "Sheet2",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/178-22/1_178-22_golden.xlsx",
        "source_id": "178-22"
      }
    },
    {
      "id": "sb_267_21_cross_sheet_lookup",
      "name": "跨表查找合并报告",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/267-21/1_267-21_init.xlsx. How can I create a comprehensive report in a single sheet ('sheet merging') in Excel that compiles data from multiple sheets, with each sheet representing monthly data? Please output the answer in the corresponding positions of columns C and D in the table, and pay attention to the mapping between the answer and column name and row value. Basically, look up ID from Column B and place the corresponding QTY value from SH1 into Column C and from RP1 into Column D. If there's an error or blank, insert \"-\".",
      "tags": ["sheet_level", "cross_sheet", "lookup", "merge_report", "spreadsheetbench"],
      "expected": {
        "answer_position": "merging'!C2:D11",
        "answer_sheet": "merging",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/267-21/1_267-21_golden.xlsx",
        "source_id": "267-21"
      }
    }
  ]
}
