{
  "suite_name": "SpreadsheetBench verified-400 抽样套件（20题）",
  "description": "从 SpreadsheetBench verified-400 分层抽样 20 题（Cell-Level 10 + Sheet-Level 10），已过滤缺失文件条目，用于评估 Agent 在真实论坛题上的端到端表现。",
  "source": "SpreadsheetBench (NeurIPS 2024) — bench/external/spreadsheetbench/spreadsheetbench_verified_400",
  "sampling": {
    "method": "stratified_random",
    "seed": 20260215,
    "total": 20,
    "cell_level": 10,
    "sheet_level": 10,
    "valid_pool_size": 394
  },
  "cases": [
    {
      "id": "sb_353_29",
      "name": "SpreadsheetBench #353-29",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/353-29/1_353-29_init.xlsx. I have an Excel spreadsheet with 15,000 rows. Each row includes a Unique Reference Number (URN) in column A and associated data & times in column B. In column A, there are some blank cells representing newly inserted rows. Instead of renumbering all the rows, I need a way to programmatically add letters to the numbers in these blank cells to create new URNs. For example, new rows 7-12 should be labeled '5a', '5b', '5c', etc., following the last numbered row. This pattern should continue such that any blank cell takes on the number of the last non-blank cell above it followed by a sequential letter (e.g., '6a', '6b', '6c' for new rows after '6'). If the number of added rows exceeds 26, the labels should proceed to 'aa', 'ab', 'ac', and so on. I鈥檓 seeking a VBA solution that could automate this process across the entire sheet. Some attempts at a solution have been made but without success, as the provided macros either haven't run as expected or nothing has happened upon running them.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'Sheet1'!A1:B90",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/353-29/1_353-29_golden.xlsx",
        "source_id": "353-29",
        "answer_sheet": "Sheet1"
      }
    },
    {
      "id": "sb_56921",
      "name": "SpreadsheetBench #56921",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/56921/1_56921_init.xlsx. I am struggling to get a SUMPRODUCT formula to work correctly in Excel. The goal is to sum every 4 columns, with the criterion being determined by column A. In the file I've attached, you'll see the formula located in C15, which currently yields an incorrect result. How do I fix this?\n\nMy current formula is: \nSUMPRODUCT(--(MOD(COLUMN(C3:N3)-COLUMN(C3),4)=0)*($A$3:$A$10=B15)*(C3:N3))",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "C15:C16",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/56921/1_56921_golden.xlsx",
        "source_id": "56921"
      }
    },
    {
      "id": "sb_3002",
      "name": "SpreadsheetBench #3002",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/3002/1_3002_init.xlsx. I need help resolving an issue with my Excel file regarding the Remark column. Originally, I sought help and received a solution involving a formula. However, I have since made modifications to the Remark column that affects the provided formula. I am including the modified example file for reference. How can I adjust the formula to work with the changes made to the Remark column? I want to see if there are multiple instances of Mat Doc and Doc No combinations. Then, remove all color and border formatting, while retaining any other formatting.  Finally, re-apply thin, all borders to all populated cells except ones that say “Multiple” or “Single”.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "G5:G15",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/3002/1_3002_golden.xlsx",
        "source_id": "3002"
      }
    },
    {
      "id": "sb_54513",
      "name": "SpreadsheetBench #54513",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/54513/1_54513_init.xlsx. How can I calculate and display the price of an item after applying a 55% discount to its original price of $34.99 in Excel? I've attached my workbook for reference.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "F8",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/54513/1_54513_golden.xlsx",
        "source_id": "54513"
      }
    },
    {
      "id": "sb_325_44",
      "name": "SpreadsheetBench #325-44",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/325-44/1_325-44_init.xlsx. I am working with data at a wtype_id, name, and status level, and I need to split the filter data from a column into specific columns of data. I've attached the input data tab and the output data tab for reference. Leave the cell which does not have any data defined blank and leading zeros can be omitted. Retain the 'Input' data tab and update the 'Output' data tab with the result.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'Output'!A1:G10",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/325-44/1_325-44_golden.xlsx",
        "source_id": "325-44",
        "answer_sheet": "Output"
      }
    },
    {
      "id": "sb_51090",
      "name": "SpreadsheetBench #51090",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/51090/1_51090_init.xlsx. How can I calculate the difference between the total cartons received as indicated in Column M and the errors present in Columns N to R, while filtering for a specific warehouse (e.g., warehouse 27), error codes (specifically for each of II, IR, IT, OV, PI with code II in column N), date, and users (e.g., CHROGIL1, CHDSPOLJ, CHSJEFFE, CHBTHOMA for each error code) across a data set? Additionally, for the IR error code listed in Column O, I only want to include positive numbers from the Errors Table. The goal is to simplify a formula that can achieve this, as my current one is too complex and not providing the correct value, such as the expected 699 for Q2.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "Daily Numbers'!Q3:Q24",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/51090/1_51090_golden.xlsx",
        "source_id": "51090"
      }
    },
    {
      "id": "sb_59224",
      "name": "SpreadsheetBench #59224",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/59224/1_59224_init.xlsx. I need assistance with an Excel spreadsheet where I have a range of predetermined dates in columns C and D. In column E, I've input a formula that will display \"Select Period\" based on a date specified in cell B2 compared to that date range, in this case cells E4 through E8. I want to have all the cells above the one displaying \"Select Period\" automatically filled with \"Select Period\" as well, with this setup responding accordingly when the Project Start Date in B2 changes. Could someone provide a solution? The spreadsheet is attached for reference. My current formula is: =IF(AND($B$2>C4,$B$2<D4),\"Select Period\",\"Do Not Select\")",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "E4:E14",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/59224/1_59224_golden.xlsx",
        "source_id": "59224"
      }
    },
    {
      "id": "sb_438_18",
      "name": "SpreadsheetBench #438-18",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/438-18/1_438-18_init.xlsx. How can I replace specific values in an array with new values while copying data from a 'sheet INPUT' to designated 'sheet OUTPUT' in Excel? In the 'sheet INPUT', column F contains values ('UNATIDE STATES AMERICAN', 'FRANCE', 'KOREA', 'GERMANY', 'ITALY'), which need to be replaced by the corresponding shortened values ('USA', 'FRA', 'KOR', 'GR', 'IT') respectively, and this result should appear in the 'sheet OUTPUT', maintaining the rest of the data intact.\nrespectively.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'OUPUT'!A1:D6",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/438-18/1_438-18_golden.xlsx",
        "source_id": "438-18",
        "answer_sheet": "OUPUT"
      }
    },
    {
      "id": "sb_50088",
      "name": "SpreadsheetBench #50088",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/50088/1_50088_init.xlsx. I am currently faced with the problem of not being able to count items in adjacent cells for each Item below Expected Answer  if the cell in a particular column is empty. How can I count the occurrences of the letter 'A' in column B, but also count 'A' in column A if the corresponding cell in column B is empty? For example, if B5 is empty, I want to check if A5 contains 'A' and include it in my count. The formula I tried is not working: =COUNTIFS($B:$B,\"A\",$B:$B,=IF($B:$B=\"\",=countif($A:$A,\"A\"))). I have provided a sample file for reference.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "F6:F8",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/50088/1_50088_golden.xlsx",
        "source_id": "50088"
      }
    },
    {
      "id": "sb_16511",
      "name": "SpreadsheetBench #16511",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/16511/1_16511_init.xlsx. How can I create a formula in Excel to increment track numbers for songs that correspond to their respective album names?",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "F2:F10",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/16511/1_16511_golden.xlsx",
        "source_id": "16511"
      }
    },
    {
      "id": "sb_42216",
      "name": "SpreadsheetBench #42216",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/42216/1_42216_init.xlsx. First add row for April in Group A, where only for that row, keep the cell blank if the value is 0. How can I transform the dataset from columns (Group A) to rows (Group B) in Excel, excluding values such as -9999 and 'M' which denote irrelevant data, and leaving NA values as blanks in Group B? For April, in Group B, assign 0s not blanks.\n   Note: \n   I want to convert columes (Data in group A) to row (Data in group B). Note: -9999 and M: indicate No Relevant Data and they can be dropped. NA: mean No Data and I want to leave as NA in group B. Other dates and Data are also required to be added in the same format as A20:A339 till 11/16/1951. and for blank values make them 0 while adding them in Group B Data and also only add Data where there are Dates.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "B20:B339",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/42216/1_42216_golden.xlsx",
        "source_id": "42216"
      }
    },
    {
      "id": "sb_109_21",
      "name": "SpreadsheetBench #109-21",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/109-21/1_109-21_init.xlsx. I need a macro to process a list, where groups are up to five people each. These people have point totals in column K. The task is to determine if an individual's point total is the highest in their group and indicate this with a 'Y' for yes or an 'N' for no in column Z. For individuals without a group (alone in their category), they should automatically receive a 'Y'. In case of a tie for the highest score within a group, all individuals with the tied highest score should get a 'Y'. The attached sample file represents a smaller portion of the actual data set which the macro will need to handle. The data is contained in columns A:X, and starts in row 5. People in the same group are in the same block (no empty rows between). No header for column Z.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'Sheet1'!Z5:Z43",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/109-21/1_109-21_golden.xlsx",
        "source_id": "109-21",
        "answer_sheet": "Sheet1"
      }
    },
    {
      "id": "sb_545_35",
      "name": "SpreadsheetBench #545-35",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/545-35/1_545-35_init.xlsx. I receive data from an external source that includes cells with alphanumeric and wildcard character contents. These cells should only contain numeric values. Given the unpredictability of these non-numeric entries, I'm having difficulty replacing them with zeros. I attempted to create a script that would find and replace any characters that are not numeric (0-9) within a selected range, but I lack a way to specify the NOT condition in my code. Can someone assist me with writing a VBA script that will replace the entire contents of a cell with zero if the cell contains anything other than pure numeric values?",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'Data'!U3:AI20",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/545-35/1_545-35_golden.xlsx",
        "source_id": "545-35",
        "answer_sheet": "Data"
      }
    },
    {
      "id": "sb_188_39",
      "name": "SpreadsheetBench #188-39",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/188-39/1_188-39_init.xlsx. How can I update a result sheet in Excel to display the designation, contact details, and email of a person when their designation matches either 'Branch Manager' or 'Branch Credit Manager' for a given location, while marking cells with 'N/A' if the designation is different? The data to be matched comes from a main sheet containing fields such as name, contact number, mail ID, and designation. The result is required in a structured format where the person's name is listed against their location, accompanied by contact details and mail ID if the designation criteria is met.  Left align all outputed entries.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'result'!B2:D12",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/188-39/1_188-39_golden.xlsx",
        "source_id": "188-39",
        "answer_sheet": "result"
      }
    },
    {
      "id": "sb_469_9",
      "name": "SpreadsheetBench #469-9",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/469-9/1_469-9_init.xlsx. I need a macro that will take debit and credit values from Column C in my Excel spreadsheet and separate them into two new columns. Specifically, it should create a new column titled 'Debits' in Column H to contain all the debit amounts, and another column titled 'Credits' in Column I for all the credit amounts, both of which should be filled in as absolute values and not filled in if there is no value. I have included a sample Excel file for reference and assistance.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "H1:I10",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/469-9/1_469-9_golden.xlsx",
        "source_id": "469-9",
        "answer_sheet": "Sheet1"
      }
    },
    {
      "id": "sb_51249",
      "name": "SpreadsheetBench #51249",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/51249/1_51249_init.xlsx. How do I create an Excel formula that outputs different results based on the text values of two different cells. For example, in D1, if B1 contains 'Description A' and B2 is blank, then D1 should display 'Single A'; if B1 contains 'Description B' and B2 is blank, then D1 should display 'Single B'; and if B1 contains 'Description A' and B2 contains 'Description B', then D1 should display 'Multiple'? I have also provided a sample spreadsheet showing the input and desired result. Do this output for each cell in column D that next to a cell that says \"Result:\". Fill any cells in column D with content with RGB: 226-239-218",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "D1,D5,D9",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/51249/1_51249_golden.xlsx",
        "source_id": "51249"
      }
    },
    {
      "id": "sb_333_29",
      "name": "SpreadsheetBench #333-29",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/333-29/1_333-29_init.xlsx. I need to find a specific date using VBA in Excel according to the following conditions: In column P of the 'A' sheet, identify the first cell that contains either 'Yes' or 'NA'. Then, in column L of the same sheet, look for the value 100 in the cells above the one identified in step 1. After finding it, take the date from the corresponding row in column F. Finally, check the text in cell F1 against the entries in column C of the 'B' sheet and, if a match is found, paste the identified date from sheet 'A' into column F of sheet 'B'. If no entries of 'Yes' or 'NA' are found in column P of the 'A' sheet, I would like the date from cell F3 of the 'A' sheet to be directly pasted into the 'B' sheet instead. The 'A' sheet should be active when the process ends. Please output the answer to cell F4 of Table B.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "B'!F4",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/333-29/1_333-29_golden.xlsx",
        "source_id": "333-29",
        "answer_sheet": "B"
      }
    },
    {
      "id": "sb_472_15",
      "name": "SpreadsheetBench #472-15",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/472-15/1_472-15_init.xlsx. I need a VB (Visual Basic) Code that can perform the following actions: If cell A1 contains the text '4Ozark', then set cell B2 to 1. If A1 contains '3Tall', then set B2 to 2. If A1 contains '1Jasper', set B2 to 3. If A1 contains '2GWood', set B2 to 4. If A1 contains '5Dawson', set B2 to 5. If A1 contains '8CPark', set B2 to 6. Also, there was a solution provided involving a MATCH formula and a VBA code snippet, but this solution seems to malfunction when I tried it. I've attached the file for reference. Please fill in the answer in cell B2.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "B2",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/472-15/1_472-15_golden.xlsx",
        "source_id": "472-15",
        "answer_sheet": "Sheet1"
      }
    },
    {
      "id": "sb_524_31",
      "name": "SpreadsheetBench #524-31",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/524-31/1_524-31_init.xlsx. I have a list of transaction descriptions in a format referred to as 'bank speak', which includes transaction identifiers like 'AMAZON.COM*1T9SS2M AMZN.COM/BILLWA' where the initial part of the identifier (before the asterisk) is consistent across different transactions for the same vendor. I've distilled these into shortened versions, such as 'amazon.com' and 'AMZN MKTP'. What I need is a way to automatically assign categories to each transaction based on their shortened versions, but without using a large nested IF formula or functions like VLOOKUP or INDEX/MATCH that won't work due to the setup. I believe this could be accomplished with VBA, but I'm not well-versed in it, so I would need some guidance or examples to understand how to implement it.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "sheet_level"
      ],
      "expected": {
        "answer_position": "'Exp-DB'!E1:E53",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/524-31/1_524-31_golden.xlsx",
        "source_id": "524-31",
        "answer_sheet": "Exp-DB"
      }
    },
    {
      "id": "sb_9448",
      "name": "SpreadsheetBench #9448",
      "message": "Open the file bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/9448/1_9448_init.xlsx. How can I create a formula in column U of my stock control spreadsheet that will retrieve and display the header value of a column from range I to T where a sale was last made? The cells from I to T represent months and contain the quantity of items sold. For example, if Item Ref 1 was last sold in April and the corresponding cell in column S7 has this information, I would like the header of S7 (April) to appear in cell U9. The spreadsheet that I use does not support the new Excel 2016 MAXIFS formula as I am limited to Excel 2010.\nI have a file for stock control where i need to see when last time we sell a product.\ni need a formula in column U which bring the header value in it if that column has got a number value.  Make sure that the displayed values in U appear as Short Date number format, using the first day of the month as the output value for the month/year combo selected.\n\nColumn G is Item Ref.\nColumn H is Item Description\nColumn I to T are the columns where i have my Quantities sold in those months \n\nfor Example \nItem Ref 1 has been sold in April Last time i am looking for a formula which can print the value of cell S7 here in Cell U9\nDon't add any headers or change anything else, keep everything as it is.",
      "tags": [
        "spreadsheetbench",
        "verified_400",
        "cell_level"
      ],
      "expected": {
        "answer_position": "'Data'!U9:U18",
        "golden_file": "bench/external/spreadsheetbench/spreadsheetbench_verified_400/spreadsheet/9448/1_9448_golden.xlsx",
        "source_id": "9448"
      }
    }
  ]
}
